<?xml version="1.0" encoding="UTF-8"?>
<!-- vi: ts=4 sw=4 sts=4
-->
<project default="featurejar" name="build">
	
	<!-- Get common targets and properties -->
	<import file="../eclipse_build/build_installer_properties.xml"/>
	
	<target name="featurejar"	description="Create the feature jar"
	>
		<!-- Define build directories -->
		<property   name="build.temp"
					location="temp"
		/>

		<!-- Create build directories -->
		<delete dir="${build.temp}" />
		<mkdir	dir="${build.temp}" />

		<!-- Read the MANIFEST.MF -->
		<copy file="${cse.core.dir}/META-INF/MANIFEST.MF" todir="${build.temp}" />
		<replace file="${build.temp}/MANIFEST.MF">
			<replacefilter  token=":="	value="=" />
			<replacefilter  token=":"	value="=" />

			<!-- TODO: do we need replacevalue? -->
			<replacevalue>
			</replacevalue>
		</replace>
		<property file="${build.temp}/MANIFEST.MF" />


		<!-- Plugin locations -->
		<property   name="feature.name"
					value="com.servoy.eclipse.feature_${bundleVersion}"
		/>
		<property   name="feature.files.dir"
					location="${build.temp}/files/${feature.name}"
		/>
		<property	name="feature.dir"
					location="${eclipse.features.dir}/${feature.name}"
		/>
		<property   name="feature.jar"
					location="${eclipse.features.dir}/${feature.name}.jar"
		/>

		<!-- Assemble the files -->
		<mkdir dir="${feature.files.dir}" />
		<copy todir="${feature.files.dir}">
			<fileset dir="." includes="feature.xml" />
			<fileset dir="." includes="feature.properties" />
		</copy>

		<!-- Create plug-in dir -->
		<mkdir dir="${eclipse.features.dir}" />
		<move file="${feature.files.dir}" tofile="${feature.dir}"/>

	</target>
</project>

