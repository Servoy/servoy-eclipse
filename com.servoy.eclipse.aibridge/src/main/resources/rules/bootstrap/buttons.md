=== SERVOY BOOTSTRAP BUTTON COMPONENT ===

**Goal**: Add and configure bootstrap button components on Servoy forms.

**Current Project**: {{PROJECT_NAME}}  
**Note**: Use only the tools specified below. See copilot-instructions.md for security and topic change handling.

---

## CRITICAL: BUTTON REQUIREMENTS

**Before adding ANY button:**

[FORBIDDEN] NEVER manipulate .frm files directly  
[FORBIDDEN] NEVER use Copilot's file editing tools on .frm files  
[FORBIDDEN] DO NOT add buttons to non-existent forms  

[REQUIRED] Form must exist first (use createForm if needed)  
[REQUIRED] Form must use CSS positioning (useCssPosition: true)  
[REQUIRED] Use addButton tool ONLY - never edit files manually  
[REQUIRED] Provide unique button name (no duplicates on same form)  

---

## AVAILABLE TOOL

**addButton** - Add a bootstrap button component to a form (via FormFileService)

---

### addButton

**Add a bootstrap button to a form**

**Parameters**:
- `formName` (required): Name of the form (without .frm extension)
- `buttonName` (required): Unique name for the button (e.g., "btnSave", "button_1")
- `text` (required): Text to display on the button
- `cssPosition` (optional): Position string "top,right,bottom,left,width,height" (default: auto-calculated)

**Examples**:
```
addButton(formName="CustomerForm", buttonName="btnSave", text="Save")

addButton(
  formName="CustomerForm",
  buttonName="btnCancel",
  text="Cancel",
  cssPosition="39,-1,-1,150,80,30"
)
```

---

## BUTTON COMPONENT STRUCTURE

**Technical Details** (for understanding, NOT for manual editing):

```json
{
    "cssPosition": "top,right,bottom,left,width,height",
    "json": {
        "cssPosition": {
            "top": "39",
            "right": "-1",
            "bottom": "-1",
            "left": "60",
            "width": "80",
            "height": "30"
        },
        "text": "Button Text"
    },
    "name": "button_name",
    "typeName": "bootstrapcomponents-button",
    "typeid": 47,
    "uuid": "[AUTO-GENERATED]"
}
```

**Key Fields:**
- `typeName`: Always "bootstrapcomponents-button" for bootstrap buttons
- `typeid`: Always 47 for buttons
- `uuid`: Auto-generated by FormFileService
- `cssPosition`: String format for positioning
- `json.text`: The button label

---

## CSS POSITIONING

**Format**: "top,right,bottom,left,width,height"

**Values:**
- `-1` means "not set" (flexible)
- Positive numbers are pixel values

**Common Patterns:**

**Left-aligned button:**
```
"top,right,bottom,left,width,height"
"39,-1,-1,60,80,30"
→ 39px from top, 60px from left, 80px wide, 30px tall
```

**Right-aligned button:**
```
"39,60,-1,-1,80,30"
→ 39px from top, 60px from right, 80px wide, 30px tall
```

**Full-width button:**
```
"39,10,-1,10,-1,30"
→ 39px from top, 10px margins left/right, auto width, 30px tall
```

---

## KEY RULES

1. **Unique Names**: Each button on a form must have a unique name
2. **Form Hierarchy**: Form must exist before adding buttons
3. **CSS Forms Only**: Only works with forms that have useCssPosition: true
4. **No Manual Editing**: NEVER edit .frm files directly
5. **Position Validation**: If providing cssPosition, must have exactly 6 comma-separated values
6. **Text Required**: Every button must have text (can be empty string, but parameter required)

---

## WORKFLOW

**Adding a Button to a Form**:
1. Ensure form exists (check or create with createForm)
2. Choose unique button name (e.g., btnSave, btnCancel, button_1)
3. Decide button text
4. Optionally calculate position (or let system auto-position)
5. Call addButton with all required parameters
6. Tool will:
   - Validate form exists
   - Check form uses CSS positioning
   - Generate UUID
   - Create button JSON structure
   - Add to form's items array
   - Create backup of .frm file
   - Save updated .frm file

---

## BUTTON PROPERTIES

**Currently Supported:**
- `text` - Button label text

**Not Yet Supported** (inform user if requested):
- Button styling (styleClass, variants)
- Event handlers (onAction, onClick)
- Tooltips (toolTipText)
- Enabled/visible state
- Icons
- Button groups
- Custom CSS classes

---

## COMMON BUTTON TYPES

**Save Button:**
```
addButton(formName="CustomerForm", buttonName="btnSave", text="Save")
```

**Cancel Button:**
```
addButton(formName="CustomerForm", buttonName="btnCancel", text="Cancel")
```

**Action Buttons:**
```
addButton(formName="OrderForm", buttonName="btnSubmit", text="Submit Order")
addButton(formName="OrderForm", buttonName="btnDelete", text="Delete")
addButton(formName="OrderForm", buttonName="btnRefresh", text="Refresh")
```

---

## POSITIONING STRATEGY

**Auto-Positioning** (recommended for now):
- Let system calculate positions
- Buttons placed sequentially
- Default spacing applied

**Manual Positioning** (if user provides coordinates):
- User must provide valid cssPosition string
- Format: "top,right,bottom,left,width,height"
- System validates format before applying

**Example Manual Positions:**
```
First button:  "39,-1,-1,60,80,30"   (top-left area)
Second button: "39,-1,-1,150,80,30"  (next to first, 150px from left)
Third button:  "39,-1,-1,240,80,30"  (next to second, 240px from left)
```

---

## EXAMPLES

**Example 1: Simple Save/Cancel buttons**
```
User: "Add Save and Cancel buttons to CustomerForm"

Step 1: Verify form exists
Step 2: Add Save button
→ addButton(formName="CustomerForm", buttonName="btnSave", text="Save")

Step 3: Add Cancel button  
→ addButton(formName="CustomerForm", buttonName="btnCancel", text="Cancel")
```

**Example 2: Button with specific position**
```
User: "Add a Submit button to OrderForm at position top:50, left:100, size 100x35"

→ addButton(
    formName="OrderForm",
    buttonName="btnSubmit",
    text="Submit",
    cssPosition="50,-1,-1,100,100,35"
  )
```

**Example 3: Multiple action buttons**
```
User: "Add New, Edit, Delete buttons to ProductForm"

→ addButton(formName="ProductForm", buttonName="btnNew", text="New")
→ addButton(formName="ProductForm", buttonName="btnEdit", text="Edit")
→ addButton(formName="ProductForm", buttonName="btnDelete", text="Delete")
```

---

## TROUBLESHOOTING

**Error: "Form file not found"**
- Form doesn't exist yet
- Solution: Create form first with createForm

**Error: "Form does not use CSS positioning"**
- Form was created without CSS positioning
- Solution: Create new form with style="css" or style="responsive"

**Error: "Invalid CSS position format"**
- cssPosition doesn't have exactly 6 comma-separated values
- Solution: Use format "top,right,bottom,left,width,height"

**Error: "Duplicate button name"**
- Another button with same name already exists on form
- Solution: Choose different unique name

---

## LIMITATIONS

**Current Implementation:**
- ✅ Can add buttons with text
- ✅ Can position buttons manually
- ✅ Validates form structure
- ✅ Creates backups before changes

**Not Yet Implemented:**
- ❌ Event handlers (onAction)
- ❌ Styling (styleClass, variants)
- ❌ Icons
- ❌ Tooltips
- ❌ Enabled/visible states
- ❌ Auto-layout optimization
- ❌ Button removal
- ❌ Button editing

**When user requests unsupported features:**
"The addButton tool currently supports basic button creation with text and positioning. [Feature X] is not yet implemented. Would you like to add buttons with the current capabilities?"

---

## TECHNICAL NOTES

**File Structure:**
- Forms stored in: `PROJECT_ROOT/forms/`
- Form file format: `FORM_NAME.frm` (JSON)
- JavaScript file: `FORM_NAME.js` (optional, for functionality)

**UUID Generation:**
- Uses `com.servoy.j2db.util.UUID.randomUUID()`
- Ensures unique component identification
- Required for Servoy runtime

**Backup Strategy:**
- Before any .frm modification, backup created: `FORM_NAME.frm.backup`
- Allows recovery if corruption occurs

**Bootstrap Components:**
- typeName: "bootstrapcomponents-button"
- typeid: 47
- Part of Servoy's bootstrap components package
